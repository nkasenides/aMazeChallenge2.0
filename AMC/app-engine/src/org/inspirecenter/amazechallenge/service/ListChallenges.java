/* --------------------------------------------------------------------------------
  This file was automatically generated by the Athlos Project Editor.
  Athlos Framework: http://nkasenides.github.io/athlos
  Generated on: 17-08-2021 12:37:25
  Athlos Project Editor, v0.1.0 BETA
-------------------------------------------------------------------------------- */

package org.inspirecenter.amazechallenge.service;
import org.inspirecenter.amazechallenge.persistence.DBManager;
import org.inspirecenter.amazechallenge.proto.ChallengeProto;
import com.nkasenides.athlos.backend.AthlosService;
import org.inspirecenter.amazechallenge.proto.ListChallengesRequest;
import org.inspirecenter.amazechallenge.auth.*;
import org.inspirecenter.amazechallenge.proto.ListChallengesResponse;

import java.util.ArrayList;

public class ListChallenges implements AthlosService<ListChallengesRequest, ListChallengesResponse> {

    @Override    
    public ListChallengesResponse serve(ListChallengesRequest request, Object... additionalParams) {

        ArrayList<ChallengeProto> challenges = new ArrayList<>();
        DBManager.challenge.list().forEach(challenge -> challenges.add(challenge.toProto().build()));

        return ListChallengesResponse.newBuilder()
                .setStatus(ListChallengesResponse.Status.OK)
                .setMessage("OK")
                .addAllChallenges(challenges)
                .build();

    }    
    
}

